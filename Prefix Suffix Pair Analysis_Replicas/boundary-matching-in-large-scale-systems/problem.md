## Title

Boundary Matching in Large-Scale Systems

## Slug

boundary-matching-in-large-scale-systems

## Difficulty

Hard

## Description

A large-scale metrics aggregation service processes continuous streams of textual identifiers generated by upstream services.
Each identifier is stored as a lowercase string and appended to an internal sequence in the order of arrival.

To ensure consistency across dependent subsystems, the platform enforces a structural validation rule between
earlier and later identifiers. An identifier is considered structurally compatible with a subsequent identifier
if it appears as both a prefix and a suffix of that later identifier.

This validation is used to detect intentional reuse of structured naming patterns, rollback-safe identifiers,
and backward-compatible string expansions across system components.

Given the complete ordered list of identifiers, the system must efficiently evaluate all eligible ordered
pairs (i, j) such that i precedes j in the sequence and the earlier identifier satisfies the defined
prefix-and-suffix compatibility rule with respect to the later one.

The goal is to compute the total number of such structurally valid ordered pairs present in the dataset,
while respecting strict performance and memory constraints typical of production-grade systems.

## Examples

### 1

#### Input
4  
a  
aba  
ababa  
aa  

#### Output
4

#### Explanation

Valid pairs are:
(0, 1), (0, 2), (0, 3), and (1, 2)

### 2

#### Input
4  
pa  
papa  
ma  
mama  

#### Output
2

#### Explanation

Valid pairs are:
(0, 1) and (2, 3)

### 3

#### Input
2  
abab  
ab  

#### Output
0

#### Explanation

No index pair satisfies the required prefix and suffix condition.

## Input Format

- First line: integer n, the number of strings
- Next n lines: each line contains one string

## Output Format

- Return a single integer representing the number of valid index pairs

## Constraints

- 1 ≤ n ≤ 100000
- 1 ≤ length of each string ≤ 100000
- All strings contain only lowercase English letters

## Time Limit

1 second

## Memory Limit

512 MB

## Tags

string
